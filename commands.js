/*! For license information please see commands.js.LICENSE.txt */
!function(){var t={63924:function(t,e,n){var r=n(64583).Promise,o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=r))((function(r,i){function s(t){try{a(o.next(t))}catch(t){i(t)}}function c(t){try{a(o.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((o=o.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=c(0),s.throw=c(1),s.return=c(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(c){return function(a){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}};function c(){var t=Office.context.mailbox.item;if("OutlookIOS"===Office.context.mailbox.diagnostics.hostName)return t.itemId;try{return Office.context.mailbox.convertToRestId(t.itemId,Office.MailboxEnums.RestVersion.v2_0)}catch(t){throw new Error("Could not convert Item ID to REST ID.")}}function a(t){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2,new r((function(e){t.body&&"function"==typeof t.body.getAsync?t.body.getAsync(Office.CoercionType.Text,(function(t){e(t.status===Office.AsyncResultStatus.Succeeded?t.value.substring(0,500):"Body preview not available.")})):e("Body preview not available.")}))]}))}))}function u(t){return i(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){return t.attachments&&0!==t.attachments.length?[2,r.all(t.attachments.map((function(n){return i(e,void 0,void 0,(function(){return s(this,(function(e){return[2,new r((function(e){n.attachmentType!==Office.MailboxEnums.AttachmentType.Item?t.getAttachmentContentAsync(n.id,{asyncContext:n.name},(function(t){t.status!==Office.AsyncResultStatus.Succeeded?e(o(o({},n),{content:null,format:null,error:"Failed to get content: ".concat(t.error.message)})):e({id:n.id,name:n.name,contentType:n.contentType,size:n.size,isInline:n.isInline,attachmentType:n.attachmentType,content:t.value.content,format:t.value.format,error:null})})):e({id:n.id,name:n.name,contentType:"message/rfc822",size:n.size,isInline:n.isInline,attachmentType:n.attachmentType,content:null,format:null,error:"Item attachment content not fetched."})}))]}))}))})))]:[2,[]]}))}))}function l(t){return i(this,void 0,void 0,(function(){var e,n=this;return s(this,(function(o){return[2,new r((function(r,o){Office.context.ui.displayDialogAsync("https://shahzadumar-w.github.io/Boligflow_Outlook_integration/ReactDialog.html",{height:75,width:50,displayInIframe:!0},(function(l){l.status===Office.AsyncResultStatus.Succeeded?((e=l.value).addEventHandler(Office.EventType.DialogEventReceived,(function(n){12006===n.error?t.completed({allowEvent:!1,errorMessage:"Dialog closed by user."}):t.completed({allowEvent:!1,errorMessage:"Dialog error occurred."});try{e.close()}catch(t){}})),e.addEventHandler(Office.EventType.DialogMessageReceived,(function(r){return i(n,void 0,void 0,(function(){var n,o,i,l,f,h,d;return s(this,(function(s){switch(s.label){case 0:if("data_request"!==(n=r.message))return[3,6];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,u(o=Office.context.mailbox.item)];case 2:return i=s.sent(),[4,a(o)];case 3:return l=s.sent(),f=o.from||o.sender,h={itemId:o.itemId,restItemId:c(),subject:o.subject||"",from:{displayName:(null==f?void 0:f.displayName)||"Unknown Sender",emailAddress:(null==f?void 0:f.emailAddress)||"unknown@example.com"},RestUrl:Office.context.mailbox.restUrl,toRecipients:o.to||[],ccRecipients:o.cc||[],bccRecipients:o.bcc||[],bodyPreview:l,attachments:i.filter((function(t){return!t.error})),errors:i.filter((function(t){return t.error})).map((function(t){return t.error}))},e.messageChild(JSON.stringify(h)),[3,5];case 4:return d=s.sent(),e.messageChild(JSON.stringify({error:"Failed to prepare email data: ".concat(d.message)})),[3,5];case 5:return[3,7];case 6:if("upload_success"===n){try{e.close()}catch(t){}t.completed({allowEvent:!0})}else if("operation_cancelled"===n||"close_dialog"===n){try{e.close()}catch(t){}t.completed({allowEvent:!1,errorMessage:"Operation cancelled by user."})}else console.warn("Unknown message from dialog: ".concat(n));s.label=7;case 7:return[2]}}))}))})),r(e)):o(new Error("Dialog failed to open: ".concat(l.error.message)))}))}))]}))}))}Office.initialize=function(t){console.log("Office initialized. Reason: ".concat(t))},Office.actions.associate("validateBeforeSend",(function(t){return i(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,l(t)];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),console.error("validateBeforeSend failed:",e),t&&"function"==typeof t.completed&&t.completed({allowEvent:!1,errorMessage:"Add-in failed: ".concat(e.message)}),[3,3];case 3:return[2]}}))}))}))},64583:function(t,e,n){t.exports=function(){"use strict";function t(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,o=void 0,i=void 0,s=function(t,e){d[r]=t,d[r+1]=e,2===(r+=2)&&(i?i(p):g())};var c="undefined"!=typeof window?window:void 0,a=c||{},u=a.MutationObserver||a.WebKitMutationObserver,l="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var t=setTimeout;return function(){return t(p,1)}}var d=new Array(1e3);function p(){for(var t=0;t<r;t+=2)(0,d[t])(d[t+1]),d[t]=void 0,d[t+1]=void 0;r=0}var v,y,m,b,g=void 0;function _(t,e){var n=this,r=new this.constructor(A);void 0===r[O]&&z(r);var o=n._state;if(o){var i=arguments[o-1];s((function(){return D(o,r,i,n._result)}))}else C(n,r,t,e);return r}function w(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(A);return I(e,t),e}g=l?function(){return process.nextTick(p)}:u?(y=0,m=new u(p),b=document.createTextNode(""),m.observe(b,{characterData:!0}),function(){b.data=y=++y%2}):f?((v=new MessageChannel).port1.onmessage=p,function(){return v.port2.postMessage(0)}):void 0===c?function(){try{var t=Function("return this")().require("vertx");return void 0!==(o=t.runOnLoop||t.runOnContext)?function(){o(p)}:h()}catch(t){return h()}}():h();var O=Math.random().toString(36).substring(2);function A(){}var x=void 0,T=1,E=2;function S(e,n,r){n.constructor===e.constructor&&r===_&&n.constructor.resolve===w?function(t,e){e._state===T?M(t,e._result):e._state===E?R(t,e._result):C(e,void 0,(function(e){return I(t,e)}),(function(e){return R(t,e)}))}(e,n):void 0===r?M(e,n):t(r)?function(t,e,n){s((function(t){var r=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,(function(n){r||(r=!0,e!==n?I(t,n):M(t,n))}),(function(e){r||(r=!0,R(t,e))}),t._label);!r&&o&&(r=!0,R(t,o))}),t)}(e,n,r):M(e,n)}function I(t,e){if(t===e)R(t,new TypeError("You cannot resolve a promise with itself"));else if(o=typeof(r=e),null===r||"object"!==o&&"function"!==o)M(t,e);else{var n=void 0;try{n=e.then}catch(e){return void R(t,e)}S(t,e,n)}var r,o}function j(t){t._onerror&&t._onerror(t._result),k(t)}function M(t,e){t._state===x&&(t._result=e,t._state=T,0!==t._subscribers.length&&s(k,t))}function R(t,e){t._state===x&&(t._state=E,t._result=e,s(j,t))}function C(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+T]=n,o[i+E]=r,0===i&&t._state&&s(k,t)}function k(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?D(n,r,o,i):o(i);t._subscribers.length=0}}function D(e,n,r,o){var i=t(r),s=void 0,c=void 0,a=!0;if(i){try{s=r(o)}catch(t){a=!1,c=t}if(n===s)return void R(n,new TypeError("A promises callback cannot return that same promise."))}else s=o;n._state!==x||(i&&a?I(n,s):!1===a?R(n,c):e===T?M(n,s):e===E&&R(n,s))}var P=0;function z(t){t[O]=P++,t._state=void 0,t._result=void 0,t._subscribers=[]}var F=function(){function t(t,n){this._instanceConstructor=t,this.promise=new t(A),this.promise[O]||z(this.promise),e(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&M(this.promise,this._result))):R(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===x&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===w){var o=void 0,i=void 0,s=!1;try{o=t.then}catch(t){s=!0,i=t}if(o===_&&t._state!==x)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===N){var c=new n(A);s?R(c,i):S(c,t,o),this._willSettleAt(c,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===x&&(this._remaining--,t===E?R(r,n):this._result[e]=n),0===this._remaining&&M(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;C(t,void 0,(function(t){return n._settledAt(T,e,t)}),(function(t){return n._settledAt(E,e,t)}))},t}();var N=function(){function e(t){this[O]=P++,this._result=this._state=void 0,this._subscribers=[],A!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){I(t,e)}),(function(e){R(t,e)}))}catch(e){R(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this,r=n.constructor;return t(e)?n.then((function(t){return r.resolve(e()).then((function(){return t}))}),(function(t){return r.resolve(e()).then((function(){throw t}))})):n.then(e,e)},e}();return N.prototype.then=_,N.all=function(t){return new F(this,t).promise},N.race=function(t){var n=this;return e(t)?new n((function(e,r){for(var o=t.length,i=0;i<o;i++)n.resolve(t[i]).then(e,r)})):new n((function(t,e){return e(new TypeError("You must pass an array to race."))}))},N.resolve=w,N.reject=function(t){var e=new this(A);return R(e,t),e},N._setScheduler=function(t){i=t},N._setAsap=function(t){s=t},N._asap=s,N.polyfill=function(){var t=void 0;if(void 0!==n.g)t=n.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=N},N.Promise=N,N}()}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n(63924)}();
//# sourceMappingURL=commands.js.map